---
layout: article
title:  "「CV」 数字水印概述"
date:   2019-07-17 10:21:40 +0800
key: steganography-survey-20190717
aside:
  toc: true
category: [AI, CV, security, digital_watermarking]
---
<span id='head'></span>
>**数字水印**是在不影响数字载体（包括多媒体——图片、视频、音频，文档，软件等）使用价值的情况下，将标识信息嵌入到载体中，以达到版权保护等作用；如果没有稳健性的要求，水印与信息隐藏技术的处理本质上是完全一致的；   

<!--more-->



<center class="half">
  <img src="/assets/images/cv/info_security/steganography/steganography.png"><br>图1：数字水印流程
</center>

*信息隐藏 · 数字水印 · 数字指纹 · 叠像术 · 潜通道*    

# 1 入门
## 1.1 概念
**数字水印**是在不影响数字载体（包括多媒体——图片、视频、音频，文档，软件等）使用价值的情况下，将标识信息嵌入到载体中，以达到版权保护等作用；如果没有稳健性的要求，水印与信息隐藏技术的处理本质上是完全一致的；   

*隐写术用于秘密信息传递，侧重于不易被察觉；数字水印用于版权保护，侧重鲁棒性；*    
*水印技术常与原始信息有关，例如隐藏版权标记等，是一对多的，而隐写术一般是一对一的；*    

## 1.2 发展
1993 年：Tirkel等人在 「A digital watermark」 中提出了数字水印概念；并提出了 LSB 方法；     
1995 年：Cox 等人提出了一种基于扩频通信思想的水印方案，大幅度提高了水印的鲁棒性；但是提取困难，需要用非盲提取；   
1996 年：Pitas 提出了一种空间域水印算法，实现了盲提取；     
1996 年：5 月，第一届信息隐藏国际学术研讨会在英国剑桥牛顿研究所召开，使得水印技术得到了迅速的发展；    
1999 年：12 月，国内召开了第一届信息隐藏学术研讨会（CHIW）；   
2009 年：3 月，由北京电子技术研究所和湖南大学共同在湖南大学召开了第八届全国信息隐藏学术研讨会；     

# 2 数字水印的特点
- **隐蔽性**：不影响被保护数据（载体）的正常使用；   
- **安全性**：难以篡改和伪造，及低误检率；    
- **鲁棒性**：    
  - 水印在通常或特定视觉条件下不可见 ;    
  - 经历多种无意或有意的信号处理过程后，数字水印仍能保持部分完整性并能被准确鉴别；    
  比如常见信号处理过程包括信道噪声、滤波、数/模与模/数转换、重采样、剪切、位移、尺度变化以及有损压缩编码等；
  - 未经授权者很难检测出水印；    
  - 经授权者能很快地抽取出水印；    
  - 加水印的图像经过印刷或重新扫描后水印仍然能被抽取出来      
- **确定性**；    
- **水印容量**：是指载体在不发生形变的前提下可嵌入的水印信息量；嵌入的水印信息必须足以表示多媒体内容的创建者或所有者的标志信息，或购买者的序列号，这样有利于解决版权纠纷，保护数字产权合法拥有者的利益；尤其是隐蔽通信领域的特殊性，对水印的容量需求很大；    


# 3 数字水印的分类
## 3.1 按特性划分
### 3.1.1 鲁棒性水印
鲁棒数字水印主要用于在数字作品中标识著作权信息，利用这种水印技术在多媒体内容的数据中嵌入创建者、所有者的标示信息，或者嵌入购买者的标示（即序列号）；在发生版权纠纷时，创建者或所有者的信息用于标示数据的版权所有者，而序列号用于追踪违反协议而为盗版提供多媒体数据的用户；用于版权保护的数字水印要求有很强的鲁棒性和安全性，除了要求在一般图像处理（如：滤波、加噪声、替换、压缩等）中生存外，还需能抵抗一些恶意攻击；    

### 3.1.2 易损水印
又叫脆弱性，Fragile Watermarking，与鲁棒水印的要求相反，易损数字水印主要用于完整性保护，这种水印同样是在内容数据中嵌入不可见的信息；当内容发生改变时，这些水印信息会发生相应的改变，从而可以鉴定原始数据是否被篡改；易损水印应对一般图像处理（如：滤波、加噪声、替换、压缩等）有较强的免疫能力（鲁棒性），同时又要求有较强的敏感性，即：既允许一定程度的失真，又要能将失真情况探测出来；必须对信号的改动很敏感，人们根据易损水印的状态就可以判断数据是否被篡改过；    
常见的应用有条形码；    

## 3.2 按载体分
>变换域方法正变得日益普遍并以小波变换的水印算法研究最热，主要是因为鲁棒性更好；        

### 3.2.1 视频
1. 在原始视频流中隐藏信息    
直接使用[静止图像](#322-图像)的隐藏算法，但是处理的数据量很大，并且抵抗压缩的能力较弱；   

1. 在 MPEG2 视频压缩算法中嵌入隐藏算法   
在压缩的同时进行信息隐藏；    

1. 在压缩后的视频信号中进行隐藏    
这类算法对视频质量影响不大，稳健性好，但是可以隐藏的数据量不大；     

### 3.2.2 图像
*BMP、GIF 格式图像为掩体的信息隐藏主要是基于时空域的，而 JPG 格式图像为掩体的信息隐藏主要是基于频域的*；    

>空间域   

具有容量大、处理简单的优点，但是隐藏信息抵抗各种处理（如滤波、压缩等）的能力比较弱；    

| 方法 | 说明 | 原理 | 特性 |
| --- | --- | --- | --- |
| 调幅 | 和扩频有点像，只不过是在空间域进行的；<br>**位平面替换**:LSB(Least Significant Bit)   | *利用人的视觉系统对 noise 不敏感原理*，在低位平面（最不重要的像素位置）嵌入水印信息； | 这种方法简单，但易受攻击； |    
| 量化型 | 需要载体是离散数据； |  | 这类水印鲁棒性较差，但是因为不受载体干扰，所以信息容量比较大； |    
| 基于调色板的隐藏 |  |  |  |
| 图像变形 |  |  |  |
| 基于视觉掩蔽效应 |  | [掩弊效应](#mask_effects) |  |   

*还有 Patchwork 、纹理块映射编码法等；*    

>变换域   

即基于扩频，隐藏信息的安全性比较强，鲁棒性好，且压缩算法大都在频域进行，比如 JPEG 的 DCT, EZW 中的小波等，所以可以考虑采用频域的方法来提高抵抗压缩操作攻击的能力；但是隐藏的数据容量有限；     

| 方法 | 说明 | 特性 |
| --- | --- | --- |
| DCT |  |  |
| DWT | 离散小波变换； |  |
| DFT |  | 具有仿射不变性，对图像的空间坐标平移不敏感，因而可以利用它来恢复经过了仿射变化的图像当中的水印； |  
| Mellin-Fourier 变换 |  |  |
| LPM 变换 | 对数极坐标变换 | 对旋转和缩放不敏感，因此利用它可以使得对水印图像的任何旋转或缩放操作都不敏感； |
| 小波 |  | 多分辨特性，使得其对图像的剪切操作不敏感；  |

### 3.2.3 音频
音频特点是采样的低电平对听觉影响较大，并且采样点间具有相关性，并且还可以利用人耳对某些声音频段的不敏感性以及对相位的不敏感性来进行信息的隐藏；    

>时域    

| 方法 | 说明 | 特性 |
| --- | --- | --- |
| 回声隐藏 |  |  |
| DFT | 相位隐藏 |  |


>频域    

| 方法 | 说明 | 特性 |
| --- | --- | --- |
| DWT | 频域隐藏 |  |

>压缩域    

>听觉掩蔽效应    

| 方法 | 说明 | 特性 |
| --- | --- | --- |
| 弱音隐藏 | [掩弊效应](#mask_effects) |  |  

*难点在于，一方面人的听觉比视觉更敏感，因此对隐藏算法的健壮性要求更高；另一方面，对声音信号的评价还没有一个比较有效的标准；*    


### 3.2.4 文本

| 方法 | 说明 | 特性 |
| --- | --- | --- |
| 调整文本的行间距、字间距来隐藏信息 |  |  |
| DF载体生成技术T | 将一段要隐藏的机密信息通过一个文本生成器，产生一段有意义的文本； |  |

*文本信号中存在的冗余度很小，因此在文本中隐藏信息是一个较困难的问题，并且隐藏信息的稳健性还有待进一步提高；*    

### 3.2.5 软件


# 4 常见的攻击
## 4.1 几何攻击
通过对水印作品进行某种处理，削弱，破坏嵌入的水印或者使水印检测器检测不出实际还存在的水印；常见的有：    

| 攻击手段 | 具体方式 |
| --- | --- |
| 噪声 | 包括加性和乘性噪声，比如高斯、均衡、斑点； |   
| 滤波 | 低通、高通、带通； |
| 信号增强 | 如锐化、增加对比度、色彩校正等； |
| 仿射变换 | 包括平移、旋转、缩放、剪切； |
| 有损压缩 | JPEG、JPEG2000、MPEG 和 MP3； |
| 模数/数模 |  |
| 代码转换 | GIF、JPEG； |

能否抵御此类攻击是目前绝大多数水印算法性能评价的首要目标；   

## 4.2 伪造攻击
又叫多重水印，即试图通过伪装原始数字作品和原始水印来迷惑版权保护；如攻击者并没有除去水印，而是在待检测作品中嵌入了他自己的水印，从而导致所有权的争议。此类攻击实际上使水印的版权保护功能受到了挑战；   

## 4.3 共谋攻击
collusion，指利用一副作品的多个加了不同水印的版本，生成一个原作品的近似，从而将水印除去；最简单的实现是假设嵌入的水印服从平均分布，利用统计或平均的方法来计算近似作品；        

# 5 评价
1. 嵌入水印的数量     

1. 嵌入的强度     

1. 数据的大小和种类     

1. 失真度量     


# 6 应用
- 纸币认证     
- 版权保护    
- 认证与防伪    
如学历证，合同，票据等，携带数字水印后，可通过制定的方式提取水印，验证证件等数字文件是否被涂改；    
- 隐式注解    
- 隐秘通信    
- 溯源    
- 广播监控     
- 视频验证    
软件在屏幕录像和视频编辑软件程序上瘫痪，鼓励用户购买完整版本以将其删除；    
- 身份证安全；    
- 真伪鉴别——欺诈和篡改检测    
- 社交网络内容管理     

# 7 相关公司
## 7.1 Digimarc
1995年，出现在美国的第一家专业从事数字水印技术应用的企业，它的产品主要面向金融文档、身份证件、数字图片等多媒体的版权保护、认证和操作跟踪等安全管理；主要产品有：    
- ImageBridge   
在公共网和指定的目标站点上搜索和跟踪含有水印信息图像的使用情况；   
- IDMarc   
为图像嵌入水印信息，实现所有者鉴别和防伪保护；   
- MarcSpider   
一种水印代理，能够自动的在网络上搜索嵌有水印图像的拷贝；    

相关功能以插件的形式集成到 Adobe Photoshop 4.0 和 Corel Draw7.0 中；    

## 7.2 Philips   
（荷兰）成功开发了基于视频内容操作跟踪的数字视频水印软件——RepliTrack，并已成功应用于防止电影评审期间的盗版发生

## 7.3 Activated Content
（美国）ActivatedAudio 系列软件是能够自同步和基于密钥加密的数字音频软件，它在设计时就结合了音频技术的基本原理和心理声学的压缩技术，能够满足数字音频的版权保护要求；    

## 7.4 Signum
（英国）SureSign 和 VeriData系列软件；   

## 7.5 Alpha
（美国）EIKONAmark 软件；    

## 7.6 MediaSec
SysCop 系列软件；    

## 7.7 Aliroo
（以色列） ScarLet；    

## 7.8 上海阿须数码
阿须数字印章、阿须数字水印条码、阿须数字手写签名、阿须PDF认证系统、阿须数字证书和阿须多媒体版权保护系统等数字安全方面的系统软件；    

## 7.9 北京中科模识
主要从事数字音频版权保护的数字音频水印软件；    

## 7.10 成都宇飞信息工程
开发了数字水印印刷防伪系统；   

## 7.11 四川联讯科技
开发了数字水印印刷防伪系统；   


-------------------  
[End](#head)
{:.warning}  

# 附录
## A 参考资料

## B 术语

| 英语 | 中文 | 英语 | 中文 |
| --- | --- | --- | --- |
| Digital Watermarking | 数字水印 | Digital Signature | 数字签名 |
| DIgital Fingerprinting | 数字指纹 | Covert channels | 隐蔽/潜信道 |
| Fragile Watermarking | 易损/脆弱性/易碎水印 | Robust watermarkin | 鲁棒性水印 |  
| Imperceptible/Invisible Watermarking | 暗/不可见水印 | Visible watermarking | 明/可见水印 |
| Anonymity | 匿名通信 | Steganography | 隐写术、信息隐藏技术 |
| Copyright marking | 版权标记 | Information Hiding | 信息隐藏 |
| collusion | 共谋攻击 | Masking | 掩弊效应 |
| Distributed source coding | 分布式信源编码 | Side Information | 边信息 |  
| Host data | 宿主数据/载体 | payload | 嵌入/隐藏容量 |
| rich model | 一种模型 | statistical moments | 统计矩 |
| cover (Signal) | 公开载体<br>没有载有秘密信息的载体 | stego (Signal) | 隐蔽载体<br>载有秘密信息的载体 |
| steganalysis | 隐写分析<br>用来判断是否载有秘密信息 | LSB | 最低有效位 |   
| co-occurrence matrix | 共生矩阵 | Discrete Cosinus | 离散余弦 |
| | | Discrete Wavelet Transform | 离散小波变换 |
| Steerable Gaussian | 可控高斯 | Nash equilibrium | 纳什均衡 |
| no modification | |  |  |
| Verification | 验证：检查媒介中欧给你是否有水印 | Detection | 检测：解读出水印 |
| Blind Detection | 盲检测：检测时不需要原始图像 | tampering of data | 数据篡改 |
| copyright | 版权 | authentication | 验证 |
| monitoring | 监听 | identification | 识别 |

*推荐看看《信息管理技术》*；   


<span id="mask_effects">**掩弊效应**</span>   
掩弊效应（Masking Effects）指多个事物同时出现时，在高掩弊事物的影响下，我们无法接收到其他事物的现象；这在声音、频域、时域和空间领域都存在；<br>比如声压级大的声音掩蔽声压级小的声音；低频声对高频声的掩蔽作用大；先发出的声音掩蔽后发出的声音；   

**叠像术**是由可视化密码技术发展而来的一种新的信息伪装技术；可视密码术的思想是把要隐藏的机密信息通过算法隐藏到两个或多个子密钥图片中；而若把所有的图片叠加在一起，则能恢复出原有的机密信息；    
多载体数字水印；    

**潜信道**又名隐信道，顾名思义，就是指普通人感觉不到此种信道的存在，从而“黑客”可以利用这些感觉不到而又真实存在的信道来传送（或存储）机密信息；潜信道的种类很多，有些潜信道是设计者有意打下的埋伏，有些潜信道则是无意之中构建的；滥用文件名，数据链路层中数据帧的未使用部分、IP 包的时间戳部分等都可以被巧妙地用来传递信息；接入控制机制中的漏洞、收发双方存在的共享资源、特洛伊木马等都可以用来构造各种各样的潜信道；     

**数字签名**（Digital Signature）技术是不对称加密算法的典型应用；数据源发送方使用自己的私钥对数据校验和或其他与数据内容有关的变量进行加密处理，完成对数据的合法“签名”，数据接收方则利用对方的公钥来解读收到的“数字签名”，并将解读结果用于对数据完整性的检验，以确认签名的合法性；数字签名技术是在网络系统虚拟环境中确认身份的重要技术，完全可以代替现实过程中的“亲笔签字”，在技术和法律上有保证；在公钥与私钥管理方面，数字签名应用与加密邮件PGP技术正好相反；在数字签名应用中，发送者的公钥可以很方便地得到，但他的私钥则需要严格保密；    
数字签名主要的功能是：保证信息传输的完整性、发送者的身份认证、防止交易中的抵赖发生；    
数字签名包括普通数字签名和特殊数字签名；普通数字签名算法有RSA、ElGmal、Fiat-Shamir、Guillou-Quisquarter、Schnorr、Ong-Schnorr-Shamir数字签名算法、Des/DSA，椭圆曲线数字签名算法和有限自动机数字签名算法等。特殊数字签名有盲签名、代理签名、群签名、不可否认签名、公平盲签名、门限签名、具有消息恢复功能的签名等，它与具体应用环境密切相关；   
数字签名技术是将摘要信息用发送者的私钥加密，与原文一起传送给接收者；接收者只有用发送的公钥才能解密被加密的摘要信息，然后用HASH函数对收到的原文产生一个摘要信息，与解密的摘要信息对比；如果相同，则说明收到的信息是完整的，在传输过程中没有被修改，否则说明信息被修改过，因此数字签名能够验证信息的完整性；    
